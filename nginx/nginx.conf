events {
    worker_connections 1024;
}

http {
    include       mime.types;
    default_type  application/octet-stream;
    
    server {
        listen 80;
        server_name localhost;

        # Web App (Next.js)
        location / {
            proxy_pass http://web:3000;
            proxy_http_version 1.1;
            proxy_set_header Upgrade $http_upgrade;
            proxy_set_header Connection 'upgrade';
            proxy_set_header Host $host;
            proxy_cache_bypass $http_upgrade;
        }

        # Grafana (via /monitor/ path - requires serving_from_sub_path env in Grafana if used)
        # For simplicity in this stack, we opened port 3001 in Security Group for direct access too.
        # But this allows access on port 80/monitor if configured.
        # NOTE: Grafana needs GF_SERVER_ROOT_URL set to work on subpath.
        # Easier to just reverse proxy root on a different port or subdomain, 
        # but for single IP, let's keep it simple:
        # We will use port 80 for Web App only as per user request to "add nginx config".
    }
}
